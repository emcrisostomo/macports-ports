# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cargo   1.0
PortGroup           github  1.0

github.setup        nushell nushell 0.69.0
github.tarball_from archive
revision            0

homepage            https://www.nushell.sh

description         A new type of shell

long_description    \
    Nushell, or Nu for short, is a new shell that takes a modern, structured \
    approach to your commandline. It works seamlessly with the data from your \
    filesystem, operating system, and a growing number of file formats to \
    make it easy to build powerful commandline pipelines.

categories          shells
installs_libs       no
license             MIT
maintainers         {@b4nst gmail.com:bastyen.a} \
                    {gmail.com:herby.gillot @herbygillot} \
                    openmaintainer


checksums           ${distname}${extract.suffix} \
                    rmd160  c97f2e0a67b050cac4d723e417ca1a1c40251e45 \
                    sha256  ee44744e64ca3d4833e7dcf46461fa40ecab671c204434bf55f10df96237a041 \
                    size    2388062

depends_lib-append  port:zlib

build.pre_args-delete \
                    --locked --frozen

build.args          --features=extra

destroot {
    xinstall -m 0755 \
        ${worksrcpath}/target/[cargo.rust_platform]/release/nu \
        ${destroot}${prefix}/bin

    xinstall -m 0644 -W ${worksrcpath} \
        LICENSE ${destroot}${prefix}/share/doc/${name}
}

test.run            yes

test.cmd            ${cargo.bin} test

test.pre_args-delete \
                    --locked --frozen

test.args           --all --features=stable

notes "
Before using Nu as a login shell, run Nu inside of another shell, like Bash.
Then, take the environment and PATH from that shell with the following commands:
    config set path \$nu.path
    config set env  \$nu.env

Next, on some distros you'll also need to ensure Nu is in the /etc/shells list.
With this, you should be able to chsh and set Nu to be your login shell.
After a logout, on your next login you should be greeted with a shiny Nu prompt.

For further informations, please read the Nu Book at https://www.nushell.sh/book/
"
